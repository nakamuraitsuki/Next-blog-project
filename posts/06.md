---
title: 'サイトを使いやすくする機能を実装した話'
date: '2025-01-07'
description: 'パンくずリスト・ページネーション・コピーボタンなどの実装で学んだこと'
---

## 概要
---
世にはびこるブログサイトを見ていると、色々とユーザの使用体験を良くする機能が実装されているのを目にします。

私のサイトにもそれを取り入れたいなと思い、今回実装に踏み切りました。

案外簡単に実装できるものもあり、非常に楽しかったです。

## パンくずリスト
---
![わがサイトのパンくずリスト](/article/06/01.png)
このように、今自分がみているページのパスを表示することで、利用者を迷子にしないようにしています。

### 実装方針
---
ヘッダーを改造してパンくずリストを表示できるようにしていきます。

Nextで作っているので、どのファイルがどのパスに対応しているかはっきりしています。

なので、パス配列を定数として用意してヘッダーに渡すようにします。

例えば、
```tsx /src/app/about
const BREAD_CLUMBS: BreadcrumbsItem[] = [
    { name: "Home", path: "/"},
    { name: "About", path: "/about" },
]
```
と書き込んでおいて、これをヘッダーに渡して表示させるかんじ。

まずは表示する配列の型を決めましょう。これは設計によりけりなので絶対的な正解はないかと思います。

私の設計はこんな感じ
```ts /src/lib/type/breadcrumbs.ts
export interface BreadcrumbsItem {
    name: string;
    path: string;
}
```
このアイテムたちの配列を受け取れるようにします。

このサイトでは、Layoutというコンポーネントを作り、ヘッダー、フッターをまとめています。
```ts 従来のLayout.tsx
import { ReactNode } from "react";
import { Header } from "./Header/Header";
import { Footnr } from "./Footer/Footer";
import styles from "./Layout.module.css";

export const Layout = ({ children }: {children: ReactNode}) => {
    return (
        <div>
            <Header/>
            <main className={styles.main}>
                {children}
            </main>
            <Footer/>
        </div>
    );
}
```
ここに、
- パンくずリストの下になる配列を受け取る
- 受け取った配列をもとにパンくずリストを作る

という二つの機能を付け足していきます。

### パンくずリストを受け取れるようにする
---
これは、単に引数にパンくずリストの配列を追加してあげるだけでよいです。

```ts Layout.tsx
interface LayoutProps {
    breadcrumbs: BreadcrumbsItem[];
    children: ReactNode;
}

export const Layout = ({ breadcrumbs ,children }: LayoutProps) => {
    return (
        <div>
            <Header/>
            <main className={styles.main}>
                {children}
            </main>
            <Footer/>
        </div>
    );
}
```

### パンくずリストコンポーネント作成
---
パンくずリストコンポーネントを作って、配列を渡したらパンくずリストJSXを返してくれるようにしてみます。

まずは、配列→パンくずリストの関数を作ります。
```tsx Breadcrumbs.tsx
const breadcrumbsTable = breadcrumbs.map((item, index): ReactNode => {
    if( index === 0) {
        return (
            <div key={index} className={styles.breadcrumbsItem}>
                <Link href={item.path}  className={styles.link} passHref>
                    {item.name}
                </Link>
            </div>
        )
    }
    return (
        <div key={index} className={styles.breadcrumbsItem}>
            <FaChevronRight className={styles.right}/>
            <Link href={item.path} className={styles.link} passHref>
                {item.name}
            </Link>
        </div>
    )
});
```
見た目の都合上、間に矢印のようなものが挟まっていると良さそうなので、そのようなJSX要素の配列を作成する関数を作りました。

あとは、これで返ってきた配列を返り値にしてあげるだけ。

```tsx Layout.tsx
export const Breadcrumbs = ({ breadcrumbs }: BreadcrumbsProps): JSX.Element => {
    //配列を元に、">"やリンクを組み込んだパンくずリストを作成する関数
    const breadcrumbsTable = breadcrumbs.map((item, index): ReactNode => {
        if( index === 0) {
            return (
                <div key={index} className={styles.breadcrumbsItem}>
                    <Link href={item.path}  className={styles.link} passHref>
                        {item.name}
                    </Link>
                </div>
            )
        }
        return (
            <div key={index} className={styles.breadcrumbsItem}>
                <FaChevronRight className={styles.right}/>
                <Link href={item.path} className={styles.link} passHref>
                    {item.name}
                </Link>
            </div>
        )
    });
    
    return (
        <div className={styles.breadcrumbs}>
            <FaHome className={styles.home} />
            {breadcrumbsTable}
        </div>
    )
}
```
横並びにするために``display: flex``みたいなCSSを当ててあげればコンポーネントが完成です。

### Layoutの中にパンくずリストを導入
---
コンポーネントを作り終えたら、Layoutの中に導入します。
```tsx Layout.tsx
import { BreadcrumbsItem } from "@/lib";
import { Breadcrumbs } from "./Breadcrumbs.tsx";

interface LayoutProps {
    breadcrumbs: BreadcrumbsItem[];
    children: ReactNode;
}

export const Layout = ({ breadcrumbs ,children }: LayoutProps) => {
    return (
        <div>
            <Header/>
            <Breadcrumbs breadcrumbs={breadcrumbs}/>
            <main className={styles.main}>
                {children}
            </main>
            <Footer/>
        </div>
    );
}
```
こんな感じ。これで、
```tsx
<Layout>
    {何らかのコンテンツ…}
</Layout>
```
と書くだけでヘッダー、フッター、パンくずリストが表示されるようになりました。

## コピーボタン
---
コードブロックがあるときに、コードを一発でコピーできるような機能を実装します。

まず、コピーボタンの部分だけの話をします。今回私が使ったのはJavaScriptのクリップボートに対するwriteTextメソッドです。

:::linkCard
https://developer.mozilla.org/en-US/docs/Web/API/Clipboard/writeText
:::

コードブロック内部のテキスト文面が``value``として保持できていれば、
```ts
navigator.clipboard.writeText(value)
```
のように書くことで利用者のクリップボードに値を書き込むことができます。
